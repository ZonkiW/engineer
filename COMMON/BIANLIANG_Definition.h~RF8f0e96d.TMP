#ifndef __BIANLIANG_Definition_H
#define __BIANLIANG_Definition_H
#include <stm32f4xx.h>

/*
变量定义
*/
#define PA0_high();  GPIO_SetBits(GPIOA,GPIO_Pin_0);
#define PA1_high();  GPIO_SetBits(GPIOA,GPIO_Pin_1);
#define PA2_high();  GPIO_SetBits(GPIOA,GPIO_Pin_2);
#define PA3_high();  GPIO_SetBits(GPIOA,GPIO_Pin_3);
#define PA4_high();  GPIO_SetBits(GPIOA,GPIO_Pin_4);
#define PA5_high();  GPIO_SetBits(GPIOA,GPIO_Pin_5);
#define PA6_high();  GPIO_SetBits(GPIOA,GPIO_Pin_6);
#define PA7_high();  GPIO_SetBits(GPIOA,GPIO_Pin_7);
#define PA8_high();  GPIO_SetBits(GPIOA,GPIO_Pin_8);
#define PA9_high();  GPIO_SetBits(GPIOA,GPIO_Pin_9);
#define PA10_high(); GPIO_SetBits(GPIOA,GPIO_Pin_10);

#define PB0_high();  GPIO_SetBits(GPIOB,GPIO_Pin_0);
#define PB1_high();  GPIO_SetBits(GPIOB,GPIO_Pin_1);
#define PB2_high();  GPIO_SetBits(GPIOB,GPIO_Pin_2);
#define PB3_high();  GPIO_SetBits(GPIOB,GPIO_Pin_3);
#define PB4_high();  GPIO_SetBits(GPIOB,GPIO_Pin_4);
#define PB5_high();  GPIO_SetBits(GPIOB,GPIO_Pin_5);
#define PB6_high();  GPIO_SetBits(GPIOB,GPIO_Pin_6);
#define PB7_high();  GPIO_SetBits(GPIOB,GPIO_Pin_7);
#define PB8_high();  GPIO_SetBits(GPIOB,GPIO_Pin_8);
#define PB9_high();  GPIO_SetBits(GPIOB,GPIO_Pin_9);
#define PB14_high(); GPIO_SetBits(GPIOB,GPIO_Pin_14);

#define PC0_high();  GPIO_SetBits(GPIOC,GPIO_Pin_0);
#define PC1_high();  GPIO_SetBits(GPIOC,GPIO_Pin_1);
#define PC2_high();  GPIO_SetBits(GPIOC,GPIO_Pin_2);
#define PC3_high();  GPIO_SetBits(GPIOC,GPIO_Pin_3);
#define PC4_high();  GPIO_SetBits(GPIOC,GPIO_Pin_4);
#define PC5_high();  GPIO_SetBits(GPIOC,GPIO_Pin_5);
#define PC6_high();  GPIO_SetBits(GPIOC,GPIO_Pin_6);
#define PC7_high();  GPIO_SetBits(GPIOC,GPIO_Pin_7);
#define PC8_high();  GPIO_SetBits(GPIOC,GPIO_Pin_8);
#define PC9_high();  GPIO_SetBits(GPIOC,GPIO_Pin_9);
#define PC10_high(); GPIO_SetBits(GPIOC,GPIO_Pin_10);

#define PD0_high();  GPIO_SetBits(GPIOD,GPIO_Pin_0);
#define PD1_high();  GPIO_SetBits(GPIOD,GPIO_Pin_1);
#define PD2_high();  GPIO_SetBits(GPIOD,GPIO_Pin_2);
#define PD3_high();  GPIO_SetBits(GPIOD,GPIO_Pin_3);
#define PD4_high();  GPIO_SetBits(GPIOD,GPIO_Pin_4);
#define PD5_high();  GPIO_SetBits(GPIOD,GPIO_Pin_5);
#define PD6_high();  GPIO_SetBits(GPIOD,GPIO_Pin_6);
#define PD7_high();  GPIO_SetBits(GPIOD,GPIO_Pin_7);
#define PD8_high();  GPIO_SetBits(GPIOD,GPIO_Pin_8);
#define PD9_high();  GPIO_SetBits(GPIOD,GPIO_Pin_9);
#define PD10_high(); GPIO_SetBits(GPIOD,GPIO_Pin_10);

#define PA0_low();  GPIO_ResetBits(GPIOA,GPIO_Pin_0);
#define PA1_low();  GPIO_ResetBits(GPIOA,GPIO_Pin_1);
#define PA2_low();  GPIO_ResetBits(GPIOA,GPIO_Pin_2);
#define PA3_low();  GPIO_ResetBits(GPIOA,GPIO_Pin_3);
#define PA4_low();  GPIO_ResetBits(GPIOA,GPIO_Pin_4);
#define PA5_low();  GPIO_ResetBits(GPIOA,GPIO_Pin_5);
#define PA6_low();  GPIO_ResetBits(GPIOA,GPIO_Pin_6);
#define PA7_low();  GPIO_ResetBits(GPIOA,GPIO_Pin_7);
#define PA8_low();  GPIO_ResetBits(GPIOA,GPIO_Pin_8);
#define PA9_low();  GPIO_ResetBits(GPIOA,GPIO_Pin_9);
#define PA10_low(); GPIO_ResetBits(GPIOA,GPIO_Pin_10);

#define PB0_low();  GPIO_ResetBits(GPIOB,GPIO_Pin_0);
#define PB1_low();  GPIO_ResetBits(GPIOB,GPIO_Pin_1);
#define PB2_low();  GPIO_ResetBits(GPIOB,GPIO_Pin_2);
#define PB3_low();  GPIO_ResetBits(GPIOB,GPIO_Pin_3);
#define PB4_low();  GPIO_ResetBits(GPIOB,GPIO_Pin_4);
#define PB5_low();  GPIO_ResetBits(GPIOB,GPIO_Pin_5);
#define PB6_low();  GPIO_ResetBits(GPIOB,GPIO_Pin_6);
#define PB7_low();  GPIO_ResetBits(GPIOB,GPIO_Pin_7);
#define PB8_low();  GPIO_ResetBits(GPIOB,GPIO_Pin_8);
#define PB9_low();  GPIO_ResetBits(GPIOB,GPIO_Pin_9);
#define PB10_low(); GPIO_ResetBits(GPIOB,GPIO_Pin_10);

#define PC0_low();  GPIO_ResetBits(GPIOC,GPIO_Pin_0);
#define PC1_low();  GPIO_ResetBits(GPIOC,GPIO_Pin_1);
#define PC2_low();  GPIO_ResetBits(GPIOC,GPIO_Pin_2);
#define PC3_low();  GPIO_ResetBits(GPIOC,GPIO_Pin_3);
#define PC4_low();  GPIO_ResetBits(GPIOC,GPIO_Pin_4);
#define PC5_low();  GPIO_ResetBits(GPIOC,GPIO_Pin_5);
#define PC6_low();  GPIO_ResetBits(GPIOC,GPIO_Pin_6);
#define PC7_low();  GPIO_ResetBits(GPIOC,GPIO_Pin_7);
#define PC8_low();  GPIO_ResetBits(GPIOC,GPIO_Pin_8);
#define PC9_low();  GPIO_ResetBits(GPIOC,GPIO_Pin_9);
#define PC10_low(); GPIO_ResetBits(GPIOC,GPIO_Pin_10);

#define PD0_low();  GPIO_ResetBits(GPIOD,GPIO_Pin_0);
#define PD1_low();  GPIO_ResetBits(GPIOD,GPIO_Pin_1);
#define PD2_low();  GPIO_ResetBits(GPIOD,GPIO_Pin_2);
#define PD3_low();  GPIO_ResetBits(GPIOD,GPIO_Pin_3);
#define PD4_low();  GPIO_ResetBits(GPIOD,GPIO_Pin_4);
#define PD5_low();  GPIO_ResetBits(GPIOD,GPIO_Pin_5);
#define PD6_low();  GPIO_ResetBits(GPIOD,GPIO_Pin_6);
#define PD7_low();  GPIO_ResetBits(GPIOD,GPIO_Pin_7);
#define PD8_low();  GPIO_ResetBits(GPIOD,GPIO_Pin_8);
#define PD9_low();  GPIO_ResetBits(GPIOD,GPIO_Pin_9);
#define PD10_low(); GPIO_ResetBits(GPIOD,GPIO_Pin_10);

#define PA0        GPIO_ReadInputDataBit(GPIOA,GPIO_Pin_0) 
#define PA1        GPIO_ReadInputDataBit(GPIOA,GPIO_Pin_1)
#define PA2        GPIO_ReadInputDataBit(GPIOA,GPIO_Pin_2)
#define PA3        GPIO_ReadInputDataBit(GPIOA,GPIO_Pin_3)
#define PA4        GPIO_ReadInputDataBit(GPIOA,GPIO_Pin_4)
#define PA5        GPIO_ReadInputDataBit(GPIOA,GPIO_Pin_5)
#define PA6        GPIO_ReadInputDataBit(GPIOA,GPIO_Pin_6)
#define PA7        GPIO_ReadInputDataBit(GPIOA,GPIO_Pin_7)
#define PA8        GPIO_ReadInputDataBit(GPIOA,GPIO_Pin_8)
#define PA9        GPIO_ReadInputDataBit(GPIOA,GPIO_Pin_9)
#define PA10       GPIO_ReadInputDataBit(GPIOA,GPIO_Pin_10)

#define PB0        GPIO_ReadInputDataBit(GPIOB,GPIO_Pin_0) 
#define PB1        GPIO_ReadInputDataBit(GPIOB,GPIO_Pin_1)
#define PB2        GPIO_ReadInputDataBit(GPIOB,GPIO_Pin_2)
#define PB3        GPIO_ReadInputDataBit(GPIOB,GPIO_Pin_3)
#define PB4        GPIO_ReadInputDataBit(GPIOB,GPIO_Pin_4)
#define PB5        GPIO_ReadInputDataBit(GPIOB,GPIO_Pin_5)
#define PB6        GPIO_ReadInputDataBit(GPIOB,GPIO_Pin_6)
#define PB7        GPIO_ReadInputDataBit(GPIOB,GPIO_Pin_7)
#define PB8        GPIO_ReadInputDataBit(GPIOB,GPIO_Pin_8)
#define PB9        GPIO_ReadInputDataBit(GPIOB,GPIO_Pin_9)
#define PB10       GPIO_ReadInputDataBit(GPIOB,GPIO_Pin_10)

#define PC0        GPIO_ReadInputDataBit(GPIOC,GPIO_Pin_0) 
#define PC1        GPIO_ReadInputDataBit(GPIOC,GPIO_Pin_1)
#define PC2        GPIO_ReadInputDataBit(GPIOC,GPIO_Pin_2)
#define PC3        GPIO_ReadInputDataBit(GPIOC,GPIO_Pin_3)
#define PC4        GPIO_ReadInputDataBit(GPIOC,GPIO_Pin_4)
#define PC5        GPIO_ReadInputDataBit(GPIOC,GPIO_Pin_5)
#define PC6        GPIO_ReadInputDataBit(GPIOC,GPIO_Pin_6)
#define PC7        GPIO_ReadInputDataBit(GPIOC,GPIO_Pin_7)
#define PC8        GPIO_ReadInputDataBit(GPIOC,GPIO_Pin_8)
#define PC9        GPIO_ReadInputDataBit(GPIOC,GPIO_Pin_9)
#define PC10       GPIO_ReadInputDataBit(GPIOC,GPIO_Pin_10)

#define PD0        GPIO_ReadInputDataBit(GPIOD,GPIO_Pin_0) 
#define PD1        GPIO_ReadInputDataBit(GPIOD,GPIO_Pin_1)
#define PD2        GPIO_ReadInputDataBit(GPIOD,GPIO_Pin_2)
#define PD3        GPIO_ReadInputDataBit(GPIOD,GPIO_Pin_3)
#define PD4        GPIO_ReadInputDataBit(GPIOD,GPIO_Pin_4)
#define PD5        GPIO_ReadInputDataBit(GPIOD,GPIO_Pin_5)
#define PD6        GPIO_ReadInputDataBit(GPIOD,GPIO_Pin_6)
#define PD7        GPIO_ReadInputDataBit(GPIOD,GPIO_Pin_7)
#define PD8        GPIO_ReadInputDataBit(GPIOD,GPIO_Pin_8)
#define PD9        GPIO_ReadInputDataBit(GPIOD,GPIO_Pin_9)
#define PD10       GPIO_ReadInputDataBit(GPIOD,GPIO_Pin_10)


#define delay_count_add()    delay_count++
#define delay_count_clear()  delay_count=0

#define delay_value   330 //上岛330

#define yes            1
#define no             0

#define UP_LEVEL      PA8
#define FRONT_LEVEL   PA9
#define BEHIND_LEVEL  PA10

#define circal_angel  360

#define Sx_rat            0//（0.8/310）
#define Sy_rat            -2.0  // 上岛 -2.0   下岛 2.2
#define Angle_rat         -0.8//(3.5/180度) (0.58/30度)  上岛-0.8 下岛0.7

#define DOWN_Sx_rat            0//（0.8/310）
#define DOWN_Sy_rat            2.2  // 上岛 -2.0   下岛 2.2
#define DOWN_Angle_rat         0.7//(3.5/180度) (0.58/30度)  上岛-0.8 下岛0.7

#define CHASIS_PositionPIDkp         15.0  //角度，左右10，0，0，10，0，0
#define CHASIS_PositionPIDki         0
#define CHASIS_PositionPIDkd         0
#define CHASIS_SpeedPIDkp            15.0
#define CHASIS_SpeedPIDki             0
#define CHASIS_SpeedPIDkd             0

#define UP_DOWN_Positionkp        15.0
#define UP_DOWN_Positionki        0
#define UP_DOWN_Positionkd        0
#define UP_DOWN_SpeedPIDkp        20.0
#define UP_DOWN_SpeedPIDki        0.1
#define UP_DOWN_SpeedPIDkd        0

#define AUX_CHASIS_FORWARD        1200//下岛（500）
#define AUX_CHASIS_BACK           -1200//上岛1200
#define AUX_CHASIS_STATIC         0
#define DOWN_AUX_CHASIS_FORWARD   500
#define DOWN_AUX_CHASIS_BACK      -500

#define PAW_Positionkp            20.0
#define PAW_Positionki            0.1
#define PAW_Positionkd            0
#define PAW_SpeedPIDkp            20.0
#define PAW_SpeedPIDki            0.1
#define PAW_SpeedPIDkd            0

#define TRAILER_Positionkp            15.0
#define TRAILER_Positionki            0
#define TRAILER_Positionkd            0
#define TRAILER_SpeedPIDkp            20.0
#define TRAILER_SpeedPIDki            0.1
#define TRAILER_SpeedPIDkd            0
 
#define CHASIS_Speedoutputmax     1500//角度（1000）左右（1500） 上岛1500 下岛1000
#define DOWN_CHASIS_Speedoutputmax  1000

#define chasis_low_step_ref         500
#define chasis_dif_step_via         1.5

#define paw_down_position           0
#define paw_up_position             -70
#define trailer_down_position       100
#define trailer_up_position         200

#define Sx_value                  1
#define Sy_value                  1
#define Angle_value               1

#define remote_forward_back_rat 3.0
#define remote_left_right_rat   3.0
#define remote_rotate_rat       3.0
#define remote_middle           1024

#define FAR_LEVEL              1
#define NEAR_LEVEL             0
#define USART_REC_LEN3  			200  
#define IMU_DMA_RX_BUF_LEN    72u
#define IMU_FRAME_LENGTH      41u
#define forward_back_speed    400 
#define left_right_speed      400 
#define rotate_speed          400 
#define CM8_11angel_add       2.0//2.5 //2.0太慢
#define CM12_13angel_add_fast     1.0
#define CM12_13angel_add_low      1.5
#define compensate_angel_add  2.0
#define CM14angel_add         2.5
#define CM12_13_ORINGE_angel_add   1.5
#define LEG_STATE_HANDLE_VALUE_HIGH 200
#define LEG_STATE_HANDLE_VALUE_LOW  -200

#define COMPUTER_FRAME_BUFLEN 22
#define UP_REG_ID             0xA5
#define HEADER_LEN            5
#define CMD_LEN               2
#define CRC_LEN               2
#define BUFFER_MAX            100
#define REMOTE_MIDDLE         1024
#define left_right_rat        2.7
#define rotate_rat            0.4
#define P_limit_value         360//300
#define remote_lose_cut       50
#define speed_level_low_rat   0.2 //0.3
#define speed_level_hign_rat  1.0

#define W_ID                  0x0001
#define S_ID                  0x0002
#define A_ID                  0x0004
#define D_ID                  0x0008
#define SHIFT_ID              0x0010
#define CTRL_ID               0x0020
#define Q_ID                  0x0040
#define E_ID                  0x0080
#define R_ID                  0x0100
#define R_SHIFT_ID            0x0110
#define F_ID                  0x0200
#define F_SHIFT_ID            0x0210
#define G_ID                  0x0400
#define G_SHIFT_ID            0x0410
#define Z_ID                  0x0800
#define Z_SHIFT_ID            0x0810
#define X_ID                  0x1000
#define X_SHIFT_ID            0x1010


#define s1_up                 1
#define s1_middle             3
#define s1_down               2

#define s2_up                 1
#define s2_middle             3
#define s2_down               2

#define CM8_9position_low     0

#define CM10_11position_low   0  //

#define CM12_13position_low   200
#define CM12_13position_high  -200
#define CM12_13position_stop  -3000
#define CM14position_low      -100
#define CM14position_high     -7300
#define die_area              400

#define over_p_rat            0.5
#define sub_p_rat             1.0

typedef struct PID_Regulator
{
	double ref;
	double fdb;
	double err[2];
	double kp;
	double ki;
	double kd;
	double componentKp;
	double componentKi;
	double componentKd;
	double componentKpMax;
	double componentKiMax;
	double componentKdMax;
	double output;
	double outputMax;
	void (*Calc)(struct PID_Regulator *pid);//函数指针
	void (*Reset)(struct PID_Regulator *pid);
	double componentoutput;
	double jump_out;
	double Reset_i;
}PID_Regulator;

typedef __packed struct
{
	uint32_t time_last;
	uint32_t time_now;
	int32_t time_error;
	uint8_t flag;
}Time_Count;

typedef __packed struct
{
  uint8_t  sof;
  uint16_t data_length;
  uint8_t  seq;
  uint8_t  crc8;
} frame_header_t;

//typedef __packed struct
//{
//  uint8_t  sof;
//  uint16_t data_length;
//  uint8_t  seq;
//  uint8_t  crc8;
//	
//	uint16_t cmdid;
//	
//	uint32_t data1;
//	uint32_t data2;
//	uint32_t data3;
//	uint8_t  data4;
//	
//} computer_tx_buf;

typedef enum//枚举型类
{    
		KEY_STATE,    				
		CONTROL_STATE,
	  ORIGIN_STATE,
	  INITIAL_STATE,
	  CLIMB_STATE,
	  DOWN_STATE,
}WorkState;

typedef enum//枚举型类
{    
		STEP1,
	  STEP2,
}climbstate;

typedef enum//枚举型类
{    
		STEP3,
	  STEP4,
}downstate;
 
typedef enum//枚举型类
{    
  FOWARD_STATE,
	STATIC_STATE,
	BACK_STATE,
	LOCA_STATE,
}CHASIS_STATE;

typedef enum//枚举型类
{    
  FIRST_STATE,
	SECOND_STATE,
	THIRD_STATE,
}PAW_HORI_STATE;

typedef enum//枚举型类
{    
  PAW_DOWN_STATE,
	PAW_UP_STATE,
}PAW_VERTI_STATE;

typedef enum//枚举型类
{    
  TRAILER_DOWN_STATE,
	TRAILER_UP_STATE,
}TRAILER_STATE;

typedef enum//枚举型类
{    
  OPEN_STATE,
	CLOSE_STATE,
}PAW_CYLINDER_STATE;

typedef enum//枚举型类
{    
  AUX_FOWARD_STATE,
	AUX_STATIC_STATE,
	AUX_BACK_STATE,
}AUX_CHASIS_STATE;

typedef struct AIM_LOCATION
{    
  double Sx;
	double Sy;
	double Angle;
}AIM_LOCATION;

typedef enum//枚举型类
{    
  NORMAL_STATE,
	PMAX_STATE,
	STOP_STATE,
}SPEED_STATE;

typedef enum//枚举型类
{    
  FAST_STEP,
	LOW_STEP,
}SPEED_STEP;


typedef __packed struct
{
	int headPosition;
	int tailPosition;
	uint8_t ringBuf[BUFFER_MAX];
}ringBuffer_t;



//20.0f 0.5f
#define CHASSIS_MOTOR_SPEED_PID_DEFAULT \
{\
	0,\
	0,\
	{0,0},\
	0.0f,\
	0.0f,\
	0.0f,\
	0,\
	0,\
	0,\
	4900,\
	3000,\
	1500,\
	0,\
	4900,\
	&PID_Calc,\
	&PID_Reset,\
	0,\
	0,\
	0,\
}\


#define PAW_MOTOR_SPEED_PID_DEFAULT \
{\
	0,\
	0,\
	{0,0},\
	0.0f,\
	0.0f,\
	0.0f,\
	0,\
	0,\
	0,\
	4900,\
	3500,\
	1500,\
	0,\
	4900,\
	&PID_Calc,\
	&PID_Reset,\
	0,\
	0,\
	0,\
}\

#define GIMBAL_MOTOR_PITCH_POSITION_PID_DEFAULT \
{\
	0,\
	0,\
	{0,0},\
	0,\
	0,\
	0,\
	0,\
	0,\
	0,\
	4900,\
	1000,\
	1500,\
	0,\
	4900,\
	&PID_Calc,\
	&PID_Reset,\
	0,\
	0,\
	0,\
}\

#define GIMBAL_MOTOR_PITCH_SPEED_PID_DEFAULT \
{\
	0,\
	0,\
	{0,0},\
	0,\
	0,\
	0,\
	0,\
	0,\
	0,\
	5000,\
	3500,\
	1500,\
	0,\
	5000,\
	&PID_Calc,\
	&PID_Reset,\
	0,\
	3,\
	0,\
}\

#define GIMBAL_MOTOR_YAW_POSITION_PID_DEFAULT \
{\
	0,\
	0,\
	{0,0},\
	0,\
	0,\
	0,\
	0,\
	0,\
	0,\
	4900,\
	1000,\
	1500,\
	0,\
	5000,\
	&PID_Calc,\
	&PID_Reset,\
	0,\
	0,\
	1,\
}\


#define GIMBAL_MOTOR_YAW_SPEED_PID_DEFAULT \
{\
	0,\
	0,\
	{0,0},\
	0,\
	0,\
	0,\
	0,\
	0,\
	0,\
	4900,\
	1000,\
	1500,\
	0,\
	4900,\
	&PID_Calc,\
	&PID_Reset,\
	0,\
	3,\
	0,\
}\

#define RAMP_GEN_DAFAULT \
{ \
							.count = 0, \
							.XSCALE = 0, \
							.out = 0, \
							.Init = &RampInit, \
							.Calc = &RampCalc, \
							.SetCounter = &RampSetCounter, \
							.ResetCounter = &RampResetCounter, \
							.SetScale = &RampSetScale, \
							.IsOverflow = &RampIsOverflow, \
} \

#define BOLUN_POSITION_PID_DEFAULT \
{\
	0,\
	0,\
	{0,0},\
	0,\
	0,\
	0,\
	0,\
	0,\
	0,\
	4900,\
	1000,\
	1500,\
	0,\
	4900,\
	&PID_Calc,\
	&PID_Reset,\
	0,\
	0,\
	0,\
}\

#define CM_POSITION_PID_DEFAULT \
{\
	0,\
	0,\
	{0,0},\
	0,\
	0,\
	0,\
	0,\
	0,\
	0,\
	4900,\
	2000,\
	1500,\
	0,\
	4900,\
	&PID_Calc,\
	&PID_Reset,\
	0,\
	0,\
	0,\
}\

#define BOLUN_SPEED_PID_DEFAULT \
{\
	0,\
	0,\
	{0,0},\
	20.0f,\
	1.0f,\
	0.0f,\
	0,\
	0,\
	0,\
	5000,\
	3500,\
	1500,\
	0,\
	5000,\
	&PID_Calc,\
	&PID_Reset,\
	0,\
	0,\
	0,\
}\

#define VAL_LIMIT(val, min, max)\
if(val<=min)\
{\
	val = min;\
}\
else if(val>=max)\
{\
	val = max;\
}\

#define VAL_LIMIT2(val, min, max)\
if(val<=min)\
{\
	val = min;\
}\
else if(val>max)\
{\
	val = min;\
}\

#define TIME_COUNT_INIT \
{\
	0,\
	0,\
	0,\
	0,\
}\

#define CAN_BUS1_MOTOR1_FEEDBACK_MSG_ID           0x201
#define CAN_BUS1_MOTOR2_FEEDBACK_MSG_ID           0x202 
#define CAN_BUS1_MOTOR3_FEEDBACK_MSG_ID           0x203
#define CAN_BUS1_MOTOR4_FEEDBACK_MSG_ID           0x204
#define CAN_BUS1_MOTOR5_FEEDBACK_MSG_ID           0x205
#define CAN_BUS1_MOTOR6_FEEDBACK_MSG_ID           0x206
#define CAN_BUS1_MOTOR7_FEEDBACK_MSG_ID           0x207
#define RATE_BUF_SIZE 6

typedef struct{
	int32_t raw_value;   									//编码器不经处理的原始值
	int32_t last_raw_value;								//上一次的编码器原始值
	int32_t ecd_value;                       //经过处理后连续的编码器值
	int32_t diff;													//两次编码器之间的差值,可以理解为速度
	uint8_t buf_count;								//滤波更新buf用
	int32_t ecd_bias;											//初始编码器值	
	int32_t ecd_raw_rate;									//通过编码器计算得到的速度原始值
	int32_t rate_buf[RATE_BUF_SIZE];	//保存RATE_BUF_SIZE次的diff
	int32_t round_cnt;										//记录圈数
	int32_t filter_rate;											//速度,对diffRATE_BUF_SIZE次平均
	double aim_ecd_angle;
	double ecd_angle;											//角度
}Encoder;

typedef struct RampGen_t
{
	int32_t count;
	int32_t XSCALE;
	float out;
	void (*Init)(struct RampGen_t *ramp, int32_t XSCALE);
	float (*Calc)(struct RampGen_t *ramp);
	void (*SetCounter)(struct RampGen_t *ramp, int32_t count);
	void (*ResetCounter)(struct RampGen_t *ramp);
	void (*SetScale)(struct RampGen_t *ramp, int32_t scale);
	uint8_t (*IsOverflow)(struct RampGen_t *ramp);
}RampGen_t;


extern float pitch_angle_static_ref;
extern float yaw_angle_static_ref;

extern volatile Encoder CM1Encoder;
extern volatile Encoder CM2Encoder;
extern volatile Encoder CM3Encoder;
extern volatile Encoder CM4Encoder;
extern volatile Encoder CM5Encoder;
extern volatile Encoder CM6Encoder;
extern volatile Encoder CM7Encoder;
extern volatile Encoder CM8Encoder;
extern volatile Encoder CM9Encoder;
extern volatile Encoder CM10Encoder;
extern volatile Encoder CM11Encoder;
extern volatile Encoder CM12Encoder;
extern volatile Encoder CM13Encoder;
extern volatile Encoder CM14Encoder;
extern volatile Encoder GMPitchEncoder;
extern volatile Encoder GMYawEncoder;

extern int16_t ch0;
extern int16_t ch1;
extern int16_t ch2;
extern int16_t ch3;
extern int16_t s1;
extern int16_t s2;
extern int16_t remote_forward_back_ref;
extern int16_t remote_left_right_ref;
extern int16_t remote_rotate_ref;
extern int16_t forward_back_ref;
extern int16_t left_right_ref;
extern int16_t rotate_ref;
extern int8_t press_l;
extern int8_t press_r;
extern int32_t key;
extern float up_down_ref;
extern u8  USART_RX_BUF3[USART_REC_LEN3]; 
extern u16 USART_RX_STA3;

extern PID_Regulator CM1SpeedPID;
extern PID_Regulator CM2SpeedPID;
extern PID_Regulator CM3SpeedPID;
extern PID_Regulator CM4SpeedPID;
extern PID_Regulator CM5SpeedPID;
extern PID_Regulator CM6SpeedPID;
extern PID_Regulator CM7SpeedPID;
extern PID_Regulator CM8SpeedPID;
extern PID_Regulator CM9SpeedPID;
extern PID_Regulator CM10SpeedPID;
extern PID_Regulator CM11SpeedPID;
extern PID_Regulator CM12SpeedPID;
extern PID_Regulator CM13SpeedPID;
extern PID_Regulator CM14SpeedPID;

extern PID_Regulator CM1PositionPID;
extern PID_Regulator CM2PositionPID;
extern PID_Regulator CM3PositionPID;
extern PID_Regulator CM4PositionPID;
extern PID_Regulator CM5PositionPID;
extern PID_Regulator CM6PositionPID;
extern PID_Regulator CM7PositionPID;
extern PID_Regulator CM8PositionPID;
extern PID_Regulator CM9PositionPID;
extern PID_Regulator CM10PositionPID;
extern PID_Regulator CM11PositionPID;
extern PID_Regulator CM12PositionPID;
extern PID_Regulator CM13PositionPID;
extern PID_Regulator CM14PositionPID;

extern PID_Regulator GMPPositionPID;     
extern PID_Regulator GMPSpeedPID;
extern PID_Regulator GMYPositionPID;			
extern PID_Regulator GMYSpeedPID;
extern PID_Regulator CM1PositionPID;
extern int16_t Gyro[3];
extern RampGen_t GMPitchRamp;
extern RampGen_t GMYawRamp;
extern RampGen_t frictionRamp;   //摩擦轮斜坡
extern RampGen_t FBSpeedRamp ;
extern RampGen_t LRSpeedRamp ;
extern RampGen_t RoSpeedRamp ;
extern RampGen_t CM8_9ramp ;
extern RampGen_t CM10_11ramp ;
extern RampGen_t CM12_13ramp ;
extern RampGen_t CM14ramp ;

extern WorkState Engineer_workstate;
extern climbstate CLIMBSTATE;
extern climbstate LAST_CLIMBSTATE;
extern downstate DOWNSTATE;
extern downstate LAST_DOWNSTATE;
extern climbstate LAST_CLIMBSTATE;
extern WorkState LAST_workstate;
extern SPEED_STATE speed_state;
extern CHASIS_STATE chasis_state;
extern CHASIS_STATE last_chasis_state;
extern AUX_CHASIS_STATE aux_chasis_state;
extern AIM_LOCATION aim_location;
extern PAW_HORI_STATE  paw_hori_state;
extern PAW_VERTI_STATE paw_verti_state;
extern PAW_CYLINDER_STATE paw_cylinder_state;
extern TRAILER_STATE trailer_state;
extern SPEED_STEP speed_step;

extern uint32_t can_count;
extern int32_t INIT_count;
extern int32_t turnaround;
extern int32_t back_car_turnaround;
extern double CM5_SPEED_VALUE;
extern double CM6_SPEED_VALUE;
extern double CM7_SPEED_VALUE;
extern double CM8_SPEED_VALUE;
extern double CM9_SPEED_VALUE;
extern double CM10_SPEED_VALUE;
extern double CM11_SPEED_VALUE;
extern double CM12_SPEED_VALUE;
extern double r_f_dif;

extern int32_t Q_PRESS;
extern int32_t E_PRESS;
extern int32_t R_PRESS;
extern int32_t F_PRESS;
extern int32_t G_PRESS;
extern int32_t Z_PRESS;
extern int32_t X_PRESS;
extern int32_t C_PRESS;
extern int32_t V_PRESS;
extern int32_t B_PRESS;
extern int32_t PRESS_MOUSE_R;
extern int32_t PRESS_MOUSE_L;
extern int32_t CS_PRESS;

extern int32_t KEY_Q_count;
extern int32_t KEY_E_count;
extern int32_t KEY_R_count;
extern int32_t KEY_F_count;
extern int32_t KEY_G_count;
extern int32_t KEY_Z_count;
extern int32_t KEY_X_count;
extern int32_t KEY_C_count;
extern int32_t KEY_V_count;
extern int32_t KEY_B_count;
extern int32_t MOUSE_R_count;
extern int32_t MOUSE_L_count;
extern int32_t KEY_CS_count;

extern double CM5PositionPID_ref;
extern double CM6PositionPID_ref;
extern double CM7PositionPID_ref;
extern double CM8PositionPID_ref;
extern double CM9PositionPID_ref;
extern double CM10PositionPID_ref;
extern double CM11PositionPID_ref;
extern double CM12PositionPID_ref;
extern double CM13PositionPID_ref;
extern double CM14PositionPID_ref;

extern int16_t mouse_left_right_slide;
extern int16_t mouse_up_down_slide;

extern uint8_t computer_tx_buf[COMPUTER_FRAME_BUFLEN];

extern uint8_t user_data[13];
extern uint8_t shuzu_cout;
extern double speed_level;
extern double speed_buchang;
extern ringBuffer_t buffer;
extern uint16_t Tail_Over_Zero_Value;
extern uint16_t Head_Over_Zero_Value;
extern uint8_t Save_Element_Array[30];
extern uint8_t CRC8_Ref_Value;
extern uint8_t CRC8_Solve_Value;
extern uint16_t CRC16_Ref_Value;
extern uint16_t CRC16_Solve_Value;
extern uint16_t data_Length;

extern double debug1;
extern double debug2;
extern double debug3;
extern double debug4;
extern uint16_t debug5;
extern uint16_t debug6;
extern uint16_t debug7;
extern uint16_t debug8;
extern uint16_t debug10;

extern uint16_t X_STATE_FLAG;
extern uint16_t V_STATE_FLAG;
extern uint16_t B_STATE_FLAG;
extern uint16_t C_STATE_FLAG;
extern uint16_t REMOTE_LOSE_COUT;

extern double OVER_P_SPEED;

extern float P_value; 
extern float user_float1; 
extern float user_float2; 
extern float user_float3; 

extern uint16_t CM8_9position_high ;
extern uint16_t CM10_11position_high;

extern uint16_t delay_count;
extern uint16_t handle_state;
extern uint16_t handle_state2;
extern uint16_t climb_step_count;
extern uint16_t down_step_count;
extern uint16_t paw_count;
extern uint16_t PAW_CHANGE_HANDLE;

extern double paw_ref;

#endif


